## 服务端项目初始化

1. 目标（Goal）

创建一个 基于 Maven 聚合的 Spring Boot 3.3.x 多模块组件化项目，
采用 DDD 分层架构，模块之间通过 Maven 依赖进行隔离。

项目根目录：

src/server


根项目为 纯父 POM，职责仅限于：

统一依赖版本管理（dependencyManagement）

统一插件管理（pluginManagement）

聚合所有子模块（modules）

2. 全局约束（Global Constraints）
语言:
  Java: 17

构建工具:
  Maven: 3.9.x

框架:
  Spring Boot: 3.3.13

坐标:
  groupId: com.mayanshe
  artifactId: nosocomium-online
  version: 0.0.1-SNAPSHOT
  packaging: pom

3. 统一依赖版本（仅在父 POM 中定义）
统一版本:
  lombok: 1.18.42
  mapstruct: 1.6.3
  hutool: 5.8.42
  commons-pool2: 2.13.0
  mybatis-spring-boot-starter: 3.0.3

依赖管理:
  必须导入:
    - org.springframework.boot:spring-boot-dependencies:${spring-boot.version}

强制规则

MySQL 驱动 必须使用

com.mysql:mysql-connector-j


Jackson / Redis / MySQL / Tomcat 版本 全部由 Spring Boot BOM 管理

Lombok + MapStruct 必须通过 annotationProcessorPaths 配置

任何子模块不得写 version

4. 模块拓扑（依赖关系图）
core.shared
 └── 无依赖

core.domain
 └── core.shared

core.application
 └── core.shared

core.infrastructure
 ├── core.shared
 ├── core.domain
 └── core.application

api.boss
 ├── core.shared
 ├── core.domain
 ├── core.application
 └── core.infrastructure

api.patient
 ├── core.shared
 ├── core.domain
 ├── core.application
 └── core.infrastructure

api.doctor
 ├── core.shared
 ├── core.domain
 ├── core.application
 └── core.infrastructure

task.all
 ├── core.shared
 ├── core.domain
 ├── core.application
 └── core.infrastructure


❗ 严禁反向依赖

5. 文件系统结构
src/server
├── pom.xml                         （父 POM）
├── core.shared
│   └── pom.xml
├── core.domain
│   └── pom.xml
├── core.application
│   └── pom.xml
├── core.infrastructure
│   └── pom.xml
├── api.boss
│   └── pom.xml
├── api.patient
│   └── pom.xml
├── api.doctor
│   └── pom.xml
└── task.all
    └── pom.xml

6. 父 POM 生成规则（强制）
6.1 模块声明
<modules>
  <module>core.shared</module>
  <module>core.domain</module>
  <module>core.application</module>
  <module>core.infrastructure</module>
  <module>api.boss</module>
  <module>api.patient</module>
  <module>api.doctor</module>
  <module>task.all</module>
</modules>

6.2 插件管理（必须）

父 POM 必须配置 maven-compiler-plugin：

编译参数:
  source: 17
  target: 17

注解处理器:
  - lombok
  - mapstruct-processor


规则：

所有子模块 继承该配置

子模块 不得自行配置 compiler plugin

7. 模块分类规则
7.1 核心模块（core.*）
类型: 类库
packaging: jar
禁止:
  - spring-boot-maven-plugin


允许依赖：

lombok（optional）

hutool

内部 core 模块（按依赖图）

7.2 可运行模块（api.* / task.all）
类型: 可执行应用
packaging: jar
必须:
  - spring-boot-maven-plugin


必选依赖：

spring-boot-starter
spring-boot-starter-web        （仅 api.*）
mybatis-spring-boot-starter
mysql-connector-j              （runtime）
spring-boot-starter-data-redis （如 infrastructure 使用）

8. 包命名规范（强制）

基础包名：

com.mayanshe.nosocomiumonline

模块	基础包
core.shared	.shared
core.domain	.domain
core.application	.application
core.infrastructure	.infrastructure
api.boss	.boss
api.patient	.patient
api.doctor	.doctor
task.all	.task
9. 启动类（必须生成）
api.boss     → BossApiApplication
api.patient  → PatientApiApplication
api.doctor   → DoctorApiApplication
task.all     → TaskAllApplication


全部必须使用：

@SpringBootApplication

10. 最小可编译校验类（必须生成）

Antigravity 必须生成以下类以确保编译通过：

core.shared:
  - shared/common/Constants.java

core.domain:
  - domain/model/DemoAggregate.java

core.application:
  - application/service/DemoAppService.java

core.infrastructure:
  - infrastructure/repository/DemoMapper.java

api.*:
  - controller/HealthController.java
    接口: GET /health

task.all:
  - runner/DemoJobRunner.java

11. 运行配置（必须）

每个可运行模块必须包含：

application.yml


端口分配：

api.boss:     8081
api.patient:  8082
api.doctor:   8083
task.all:     8090


敏感信息 必须使用环境变量占位：

spring.datasource.password: ${DB_PASSWORD:password}

12. 验收标准（不可跳过）
cd src/server
mvn clean package -DskipTests

mvn -pl api.boss spring-boot:run
curl http://localhost:8081/health


必须返回 HTTP 200

13. 强制禁止项

❌ core.domain 依赖 core.infrastructure

❌ core 模块使用 Spring Boot 插件

❌ 子模块声明依赖版本

❌ 非父 POM 管理依赖版本

✅ 全模块 Java 17 编译通过